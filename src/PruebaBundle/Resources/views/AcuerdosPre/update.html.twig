{% extends '::base.html.twig'  %}

{% block body %}


	{{dump(acuerdosPre)}}
	{{dump(acuerdosPre.areaIpd.id)}}
	{{dump(observaciones)}}
	{{cantidadObservaciones}}

	

		<p>{{observaciones[cantidadObservaciones-1].descripcion}}</p>

	
<a href="/acuerdosPre"><button style="margin-left:30px;"  class="btn btn-info btn-lg">Regresar</button></a>

<h2 class="text-center">SEGUIMIENTO DE LOS ACUERDOS DE LOS COMITES DE PRESIDENCIA</h2>

<div style="width:70%; height:400px; margin:0 auto;">


	<div class="form-group col-md-6 col-lg-6">
		<label>Comite</label>
		<input type="number" name="comite"  id="comite" class="form-control">
	</div>

	<div class="form-group col-md-6 col-lg-6">
		<label>Fecha</label>
		<input type="date" name="fecha"  id="fecha" class="form-control">
	</div>

	<div class="form-group col-md-6 col-sm-6 col-lg-6">
		<label>Acuerdos Adoptados</label>
		<input type="text" name="acuerdos"  id="acuerdos"  class="form-control">
	</div>

	<div class="form-group col-md-6 col-sm-6 col-lg-6" >
		<label>NÂ° del acuerdo</label>
		<input type="number" name="nroAcuerdo" id="nroAcuerdo"  class="form-control">
	</div>


	<div class="form-group col-md-6 col-sm-6 col-lg-6">
		<label>Area Responsable</label>
		<select  name="areaIpd" id="areaIpd"  class="form-control">
		</select>
	</div>


	<div class="form-group col-md-6 col-sm-6 col-lg-6">
		<label>Estado</label>
		
		<select name="estado" id="estado"  class="form-control">
			<option value="En Proceso">En Proceso</option>
			<option value="Implementado" >Implementado</option>
			<option value="Cancelado">Cancelado</option>
		</select>
	</div>


	<div class="form-group col-md-6 col-sm-6 col-lg-6">
		<label>Observaciones</label>
		<textarea type="text" name="observaciones" id="observaciones" class="form-control"></textarea>
	</div>


	<div class="form-group col-md-6 col-sm-6 col-lg-6">
		<label>Plazo de Entrega</label>
		<input type="date" name="plazoEntrega" id="plazoEntrega"  class="form-control">
	</div>

	<button class="btn btn-primary" id="boton-editar-acuerdosPre">Editar</button>

</div>

<script>


$(document).ready(function(){

	$("#comite").val({{acuerdosPre.comite}});
	$("#acuerdos").val( "{{ acuerdosPre.acuerdos }}" );
	$("#fecha").val( "{{ acuerdosPre.fecha}}" );
	$("#nroAcuerdo").val( "{{ acuerdosPre.nroAcuerdo}}" );
	$("#plazoEntrega").val( "{{ acuerdosPre.plazoEntrega}}" );
	$("#observaciones").val("{{observaciones[cantidadObservaciones-1].descripcion}}");

	var sel = document.getElementById("estado");

	for (let i = 0; i < sel.length; i++) {
		
		if(sel[i].value === "{{acuerdosPre.estado}}" ){

			sel[i].setAttribute('selected','selected');

		}
	}

	console.log(sel[0].value);	

	$.ajax({
		type:"GET",
		url:"{{ url('prueba_getArea') }}",
		dataType:'json',
		success:function(data){
		console.log(JSON.parse(data));
		JSON.parse(data).forEach(function(valor,index){

			if(valor.id == {{ acuerdosPre.areaIpd.id }} ){
				$("#areaIpd").append("<option selected='selected' value='"+valor.id+"'>"+valor.nombre+"</option>");
			}else{
				$("#areaIpd").append("<option value='"+valor.id+"'>"+valor.nombre+"</option>");
			}

			
		});

		},
		error:function(error){
			console.log(error);
		}

	});	




		$("#boton-editar-acuerdosPre").on('click',function(){

			postEditAcuerdosPre();			

		});


			function postEditAcuerdosPre(){

				datos={

					comite: $("#comite").val(),
					fecha: $("#fecha").val(),
					acuerdos: $("#acuerdos").val(),
					nroAcuerdo: $("#nroAcuerdo").val(),
					areaIpd: $("#areaIpd").val(),
					estado: $("#estado").val(),
					observaciones: $("#observaciones").val(),
					plazoEntrega: $("#plazoEntrega").val()

				}


				$.ajax({

					dataType: 'json',
					type: 'POST',
					url: "/acuerdosPre/update/{{id}}",
					data:datos,

					success:function(data){
						var datosAcuerdosPre=JSON.parse(data);
						

							console.log(datosAcuerdosPre);	
							

					},

					error:function(error){
						console.log(error);
					}


				});

			}

});


</script>


{%  endblock %}